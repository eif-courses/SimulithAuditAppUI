@page "/Categories"
@using SimulithAuditAzureUI.Components
@attribute [Authorize]
@inject AuthenticationStateProvider authProvider
@inject IUserData userData
@inject IStringLocalizer<App> Localizer
@inject AuthenticationStateProvider authProvider
@inject IUserData userData
@inject ICategoryData categoryData
@inject NavigationManager navManager



@if (_categories != null)
{
@*<MudTextField @bind-Value="TextValue" Label="Standard" Variant="Variant.Text"></MudTextField>
<MudTextField @bind-Value="DescriptionText" T="string" Label="Outlined" Variant="Variant.Outlined" Placeholder="Description" Lines="3" />

    <MudButton OnClick="CreateCategory" Variant="Variant.Filled">Create category</MudButton>
    
    
    <MudButton OnClick="DeleteCategory" Color="Color.Error" Variant="Variant.Filled">Delete category</MudButton>
    <MudDataGrid Items="@_categories" MultiSelection="true" >
    <Columns>
        <SelectColumn T="CategoryModel" />
        <Column T="CategoryModel" Field="CategoryName" />
        <Column T="CategoryModel" Field="CategoryDescription" />
    </Columns>
</MudDataGrid>*@



<MudContainer Class="d-flex justify-center mb-2">
    <MudFab Color="Color.Primary" Icon="@Icons.Material.Filled.Add" Size="Size.Large" IconSize="Size.Large" Label="Add A New
    Cake" Class="ma-2" @onclick="(e => CreateCategory())"/>
</MudContainer>
<MudGrid Justify="Justify.Center" class="pr-4 pl-4">
    @foreach (var category in _categories)
    {
        <MudItem xs="3">
            <MudCard>
                <MudCardHeader>
                    <CardHeaderContent>
                        <MudText Typo="Typo.body1">@category.CategoryName</MudText>
                        <MudText Typo="Typo.h6">@category.Id $</MudText>
                    </CardHeaderContent>
                </MudCardHeader>
                <MudCardMedia Image="https://www.logodesign.net/images/nature-logo.png" Height="250" />
                <MudCardContent>
                    <MudText Typo="Typo.body2">@category.CategoryDescription</MudText>
                </MudCardContent>
                <MudCardActions>
                    <MudIconButton Icon="@Icons.Filled.Edit" Color="Color.Primary"/>
                    <MudIconButton Icon="@Icons.Filled.Delete" Color="Color.Error" @onclick="(e => DeleteCategory(category.CategoryName))" />
                </MudCardActions>
            </MudCard>

        </MudItem>

    }

</MudGrid>



}


@code {
   
   


    public string TextValue { get; set; }

    public string SomeValue { get; set; }


    public string DescriptionText { get; set; }

    private List<CategoryModel> _categories = new List<CategoryModel>();

    protected async override Task OnInitializedAsync()
    {
        _categories = await categoryData.GetAllCategories();
    }


    private async Task CreateCategory(){
        // var loggedUser = authProvider.GetUserFromAuth(userData);


        CategoryModel category = new()
            {
                CategoryName = TextValue,
                CategoryDescription = DescriptionText

            };
        await categoryData.CreateCategory(category);
    }


   











    private async Task DeleteCategory(string id)
    {
        await categoryData.DeleteCategory(id);
        
    }




   
}




@* public string Id { get; set; }
    public string CategoryName { get; set; }
    public string CategoryDescription { get; set; }
  }*@